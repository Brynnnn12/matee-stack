<div class="p-6 md:ml-64">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-2xl font-bold text-yellow-400 mb-6">Genres</h1>

    <% if (message && message.length > 0) { %>
    <div class="bg-green-700 text-white px-4 py-2 rounded mb-4">
      <%= message %>
    </div>
    <% } %>

    <!-- Form Create Genre -->
    <form
      action="/dashboard/genres"
      method="POST"
      class="mb-6 bg-gray-700 p-4 rounded border-2 border-gray-600"
    >
      <h2 class="text-lg font-semibold text-yellow-300 mb-2">Add New Genre</h2>
      <div class="mb-4">
        <input
          type="text"
          name="name"
          placeholder="Genre Name"
          class="w-full px-3 py-2 rounded border border-gray-600 bg-gray-800 text-white focus:outline-none"
          required
        />
        <% if (errors) { %> <% errors.forEach((error) => { %> <% if (error.param
        === 'name') { %>
        <p class="text-red-400 text-sm mt-2"><%= error.msg %></p>
        <% } %> <% }) %> <% } %>
      </div>
      <button
        type="submit"
        class="bg-yellow-400 hover:bg-yellow-500 text-gray-900 font-bold px-4 py-2 rounded"
      >
        Add Genre
      </button>
    </form>

    <!-- Genre List Table -->
    <div class="bg-gray-700 rounded border-2 border-gray-600 p-4">
      <h2 class="text-lg font-semibold text-yellow-300 mb-3">Genre List</h2>
      <% if (genres.length === 0) { %>
      <p class="text-gray-400">No genres found.</p>
      <% } else { %>
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm">
          <thead>
            <tr class="bg-gray-800 text-yellow-400">
              <th class="py-2 px-3 text-left">#</th>
              <th class="py-2 px-3 text-left">Name</th>
              <th class="py-2 px-3 text-left">Slug</th>
              <th class="py-2 px-3 text-left">Created At</th>
              <th class="py-2 px-3 text-left">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% genres.forEach((genre, idx) => { %>
            <tr class="border-b border-gray-600">
              <td class="py-2 px-3"><%= ((page - 1) * 10) + idx + 1 %></td>
              <td class="py-2 px-3"><%= genre.name %></td>
              <td class="py-2 px-3 text-gray-400"><%= genre.slug %></td>
              <td class="py-2 px-3">
                <%= genre.createdAt.toLocaleDateString() %>
              </td>
              <td class="py-2 px-3 space-x-2">
                <!-- Edit Form (inline) -->
                <form
                  action="/dashboard/genres/<%= genre.slug %>?_method=PUT"
                  method="POST"
                  class="inline"
                >
                  <input
                    type="text"
                    name="name"
                    value="<%= genre.name %>"
                    class="px-2 py-1 rounded border border-gray-600 bg-gray-800 text-white text-xs w-24"
                  />
                  <button
                    type="submit"
                    class="bg-blue-500 hover:bg-blue-600 text-white font-bold px-2 py-1 rounded text-xs"
                  >
                    Update
                  </button>
                </form>
                <!-- Delete Form -->
                <form
                  action="/dashboard/genres/<%= genre.slug %>?_method=DELETE"
                  method="POST"
                  class="inline"
                  onsubmit="return confirm('Are you sure you want to delete this genre?')"
                >
                  <button
                    type="submit"
                    class="bg-red-500 hover:bg-red-600 text-white font-bold px-2 py-1 rounded text-xs"
                  >
                    Delete
                  </button>
                </form>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
      <% } %>
    </div>

    <!-- Pagination -->
    <% if (pages > 1) { %>
    <div class="flex justify-center mt-6 space-x-2">
      <% for(let i = 1; i <= pages; i++) { %>
      <a
        href="?page=<%= i %>&limit=10"
        class="px-3 py-1 rounded border-2 border-gray-600 bg-gray-700 text-yellow-400 hover:border-yellow-400 hover:bg-gray-600 <% if (i === page) { %> font-bold border-yellow-400 bg-gray-800<% } %>"
        ><%= i %></a
      >
      <% } %>
    </div>
    <% } %>
  </div>
</div>
